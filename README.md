# 🎵 Fake Audio Detection (음성 위조 탐지)

**해당 코드는 교내 대회에서 사용되었으며, 데이터는 제공되지 않습니다.**

---

## 📝 개요

본 프로젝트는 음성 데이터를 분석하여 **실제(real) 음성과 위조(fake) 음성을 판별하는 모델**을 개발하는 것입니다. 데이터 불균형 문제를 해결하기 위한 데이터 증강 기법과, 오디오 데이터의 길이를 정규화하는 전처리 과정이 포함되어 있습니다.

---

## 💻 설치 방법

### 필수 라이브러리 설치
아래 명령어를 실행하여 필요한 라이브러리를 설치하세요.

```bash
pip install torch torchaudio numpy
```

또는 `requirements.txt` 파일이 제공된다면 아래 명령어로 한 번에 설치할 수 있습니다.

```bash
pip install -r requirements.txt
```

---

## 🛠 라이브러리 및 유틸리티 함수

### 1️⃣ 유틸리티 함수

#### **find_wav_files(path_to_dir)**
- 주어진 디렉토리 내 `.wav` 파일을 재귀적으로 검색하고 정렬하여 반환합니다.

#### **set_seed(seed)**
- 실험의 재현성을 위해 NumPy, PyTorch, Python Random의 시드를 고정합니다.

### 2️⃣ 사용된 주요 라이브러리
- **`os`** : 파일 및 디렉토리 관리
- **`random`** : 무작위성 제어
- **`torch, torchaudio`** : 딥러닝 및 오디오 데이터 처리

---

## 🎵 데이터셋 처리

### 1️⃣ **AudioDataset**
- `.wav` 파일을 로드하고 **Tensor 형식**으로 변환합니다.
- 샘플레이트를 **16kHz**로 통일하여 데이터 일관성을 유지합니다.
- **real 데이터의 개수가 부족한 문제(1:7 불균형)를 해결**하기 위해 real 데이터를 7배 증강합니다.

### 2️⃣ **PadDataset**
- 모든 오디오 데이터의 길이를 **4초(64,600 샘플)**로 통일합니다.
  - **4초보다 긴 경우:** 앞부분을 유지하고 뒷부분을 자릅니다.
  - **4초보다 짧은 경우:** 반복 재생하여 길이를 맞춥니다.

### 3️⃣ **데이터 로딩 함수**
- `load_dataset()`: 학습용 데이터 로드 (real과 fake 데이터를 구분하여 처리)
- `load_dataset_test()`: 테스트 데이터 로드 (4초 길이로 패딩 처리)

---

## 🏗 모델 구성

### 1️⃣ **RawNet 모델**
본 프로젝트는 **RawNet** 모델을 기반으로 음성 위조 여부를 판별합니다.

#### 📌 **모델 개요**
- `RawNet`은 오디오 데이터를 입력받아 **real/fake 확률을 출력**하는 신경망 모델입니다.
- 모델 내부에 **SincConv(특수한 컨볼루션 계층)** 과 **Residual_block(잔차 블록)** 이 포함되어 있습니다.

#### 🏗 **모델 구성 요소**
- `class RawNet(nn.Module)`: `torch.nn.Module`을 상속받아 정의됨.
- `SincConv`: 오디오 데이터를 처리하기 위한 SincNet 기반 컨볼루션 계층.
- `Residual_block`: 깊은 신경망 학습을 위해 잔차 블록을 사용.
- `Trainer / GDTrainer`: 모델 학습 및 평가를 위한 훈련 클래스.
- `forward()`: 입력 데이터를 순전파(forward) 처리하여 예측값 출력.

---

## 🚀 주요 기능

✅ **오디오 파일 처리**
- `.wav` 파일을 찾아 로드하고 텐서로 변환합니다.
- 샘플레이트를 16kHz로 통일하여 데이터 일관성을 유지합니다.

✅ **데이터 전처리 및 증강**
- 데이터 불균형(1:7) 문제 해결을 위해 **real 데이터를 7배 증강**합니다.
- 모든 오디오의 길이를 **4초로 맞춰** 모델 학습의 일관성을 유지합니다.

✅ **모델 학습**
- **RawNet 기반 모델**을 사용하여 음성 위조 여부를 예측합니다.

---

## 📄 라이선스

이 프로젝트는 **교내 대회**에서 사용된 코드이며, 데이터는 제공되지 않습니다.

